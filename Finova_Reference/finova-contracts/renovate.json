{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:base",
    "security:openssf-scorecard",
    ":dependencyDashboard",
    ":semanticCommits",
    ":separatePatchReleases"
  ],
  "timezone": "Asia/Jakarta",
  "schedule": [
    "before 6am on Monday"
  ],
  "labels": ["dependencies"],
  "assignees": ["@finova-network/core-team"],
  "reviewers": ["@finova-network/security-team"],
  "prConcurrentLimit": 3,
  "prHourlyLimit": 2,
  "stabilityDays": 3,
  "minimumReleaseAge": "3 days",
  "packageRules": [
    {
      "description": "Group Anchor Framework updates",
      "groupName": "Anchor Framework",
      "matchPackagePatterns": ["^anchor-"],
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "7 days"
    },
    {
      "description": "Group Solana updates",
      "groupName": "Solana SDK",
      "matchPackagePatterns": ["^solana-"],
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "7 days"
    },
    {
      "description": "Group SPL Token updates", 
      "groupName": "SPL Tokens",
      "matchPackagePatterns": ["^spl-"],
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "7 days"
    },
    {
      "description": "Group Metaplex updates",
      "groupName": "Metaplex",
      "matchPackagePatterns": ["^mpl-"],
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "7 days"
    },
    {
      "description": "Critical security updates",
      "matchPackageNames": [
        "openssl",
        "libssl-dev",
        "openssl-sys"
      ],
      "schedule": ["at any time"],
      "minimumReleaseAge": "0 days",
      "labels": ["security", "critical"]
    },
    {
      "description": "Development dependencies",
      "matchDepTypes": ["devDependencies"],
      "matchPackagePatterns": [
        "^@types/",
        "^eslint",
        "^prettier",
        "^jest",
        "^typescript"
      ],
      "groupName": "dev dependencies",
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "1 day"
    },
    {
      "description": "Rust development tools",
      "matchPackageNames": [
        "rustfmt",
        "clippy",
        "cargo-audit",
        "cargo-deny"
      ],
      "groupName": "Rust dev tools",
      "schedule": ["before 6am on Monday"]
    },
    {
      "description": "Docker base images",
      "matchPackageNames": [
        "rust",
        "node",
        "postgres",
        "redis"
      ],
      "matchDatasources": ["docker"],
      "groupName": "Docker base images",
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "3 days"
    },
    {
      "description": "GitHub Actions",
      "matchFileNames": [".github/workflows/**"],
      "groupName": "GitHub Actions",
      "schedule": ["before 6am on Monday"],
      "minimumReleaseAge": "3 days"
    }
  ],
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security", "vulnerability"],
    "assignees": ["@finova-network/security-team"],
    "reviewers": ["@finova-network/security-team"],
    "schedule": ["at any time"],
    "minimumReleaseAge": "0 days"
  },
  "osvVulnerabilityAlerts": true,
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": ["before 6am on Monday"],
    "commitMessageAction": "Lock file maintenance"
  },
  "rust": {
    "enabled": true,
    "rangeStrategy": "bump"
  },
  "cargo": {
    "enabled": true,
    "rangeStrategy": "bump"
  },
  "npm": {
    "enabled": true,
    "rangeStrategy": "bump"
  },
  "docker": {
    "enabled": true,
    "pinDigests": true
  },
  "regexManagers": [
    {
      "description": "Update Rust version in Dockerfile",
      "fileMatch": ["^Dockerfile"],
      "matchStrings": ["FROM rust:(?<currentValue>\\S+)"],
      "datasourceTemplate": "docker",
      "depNameTemplate": "rust"
    },
    {
      "description": "Update Node version in Dockerfile",
      "fileMatch": ["^Dockerfile"],
      "matchStrings": ["FROM node:(?<currentValue>\\S+)"],
      "datasourceTemplate": "docker", 
      "depNameTemplate": "node"
    },
    {
      "description": "Update Anchor version in comments",
      "fileMatch": ["^programs/.*/Cargo.toml$"],
      "matchStrings": ["# anchor-lang = \"(?<currentValue>\\S+)\""],
      "datasourceTemplate": "crate",
      "depNameTemplate": "anchor-lang"
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Solana version in CI",
      "fileMatch": ["^\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": ["solana-install init (?<currentValue>\\S+)"],
      "datasourceTemplate": "github-releases",
      "depNameTemplate": "solana-labs/solana"
    }
  ],
  "semanticCommits": "enabled",
  "semanticCommitType": "chore",
  "semanticCommitScope": "deps",
  "commitMessageTopic": "{{depName}}",
  "commitMessageExtra": "to {{newVersion}}",
  "commitMessageSuffix": "",
  "rangeStrategy": "bump",
  "bumpVersion": "patch",
  "gitIgnoredAuthors": ["renovate[bot]"],
  "platformAutomerge": false,
  "automerge": false,
  "major": {
    "enabled": false
  },
  "platformCommit": true,
  "draftPR": false,
  "assigneesFromCodeOwners": true,
  "reviewersFromCodeOwners": true,
  "prCreation": "immediate",
  "prNotPendingHours": 24,
  "branchConcurrentLimit": 3,
  "prBodyDefinitions": {
    "Age": "This PR has been generated by [Renovate Bot](https://renovatebot.com).",
    "Adoption": "",
    "Passing": "",
    "Confidence": ""
  },
  "prBodyColumns": ["Package", "Change", "Age", "Adoption", "Passing", "Confidence"],
  "prBodyNotes": [
    "- üîí **Security**: This update addresses security vulnerabilities",
    "- ‚ö†Ô∏è **Breaking**: This update may contain breaking changes", 
    "- üìù **Changelog**: Check the [CHANGELOG.md](../CHANGELOG.md) for migration notes",
    "- üß™ **Testing**: Ensure all tests pass before merging",
    "- üöÄ **Deployment**: Consider the impact on deployed contracts"
  ],
  "ignoreDeps": [
    "solana-program-test"
  ],
  "ignorePaths": [
    "**/node_modules/**",
    "**/target/**",
    "**/.git/**"
  ],
  "includeNodeModules": false,
  "followTag": "latest"
}
